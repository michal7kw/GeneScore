INFO: localdir at /localscratch/13716218.michal.kubacki
INFO: your job will run on local system.
Assuming unrestricted shared filesystem usage for local execution.
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 96
Rules claiming more threads will be scaled down.
Job stats:
job                            count
---------------------------  -------
AUCell_direct                      1
AUCell_extended                    1
all                                1
download_genome_annotations        1
eGRN_direct                        1
eGRN_extended                      1
get_search_space                   1
motif_enrichment_cistarget         1
motif_enrichment_dem               1
prepare_GEX_ACC_multiome           1
prepare_menr                       1
region_to_gene                     1
scplus_mudata                      1
tf_to_gene                         1
total                             14

Select jobs to execute...
Execute 1 jobs...

[Thu Jul 18 21:26:16 2024]
localrule motif_enrichment_cistarget:
    input: /group/testa/michal.kubacki/herring/output_hg19_all_cells/region_sets, /group/testa/michal.kubacki/herring/output_hg19_all_cells/cistarget_motif_dataset.regions_vs_motifs.rankings.feather, /group/testa/michal.kubacki/herring/scenic_input/motifs-v10nr_clust-nr.hgnc-m0.001-o0.0.tbl
    output: /group/testa/michal.kubacki/herring/scenic_all_cells/ctx_results.hdf5, /group/testa/michal.kubacki/herring/scenic_all_cells/ctx_results.html
    jobid: 9
    reason: Forced execution
    threads: 96
    resources: tmpdir=/localscratch/13716218.michal.kubacki

Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)2024-07-18 21:27:41,525 SCENIC+      INFO     Reading region sets from: /group/testa/michal.kubacki/herring/output_hg19_all_cells/region_sets
2024-07-18 21:27:41,538 SCENIC+      INFO     Reading all .bed files in: Topics_top_3k
2024-07-18 21:27:42,924 SCENIC+      INFO     Reading all .bed files in: DARs_cell_type
2024-07-18 21:27:43,816 SCENIC+      INFO     Reading all .bed files in: Topics_otsu
Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/externals/loky/process_executor.py:752: UserWarning: A worker stopped while some jobs were given to the executor. This can be caused by a too short worker timeout or by a memory leak.
  warnings.warn(
Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)Error.  nthreads cannot be larger than environment variable "NUMEXPR_MAX_THREADS" (64)2024-07-18 21:43:11,732 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:11,732 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:11,744 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:12,119 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:12,644 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:12,785 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:13,624 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:14,128 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:16,733 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:18,703 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:18,732 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:18,734 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:18,805 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:19,223 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:31,568 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:31,638 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:31,658 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:31,658 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:31,680 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:33,811 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:35,763 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:36,982 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:37,253 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:37,269 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:37,271 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:37,276 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:37,300 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:37,400 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:37,425 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:37,509 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:37,619 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:37,637 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:37,654 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:37,684 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:37,773 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:37,810 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:37,811 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:37,814 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:37,865 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:37,890 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:37,914 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,028 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,050 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,069 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,070 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,078 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,106 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,117 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,184 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,226 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,273 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,319 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,339 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,356 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,383 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,388 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,394 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,403 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,416 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,457 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,541 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,605 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,682 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,682 cisTarget    INFO     Reading cisTarget database
2024-07-18 21:43:38,735 cisTarget    INFO     Reading cisTarget database
Traceback (most recent call last):
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/bin/scenicplus", line 33, in <module>
    sys.exit(load_entry_point('scenicplus', 'console_scripts', 'scenicplus')())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/michal.kubacki/Downloads/scenicplus/src/scenicplus/cli/scenicplus.py", line 1137, in main
    args.func(args)
  File "/home/michal.kubacki/Downloads/scenicplus/src/scenicplus/cli/scenicplus.py", line 386, in motif_enrichment_cistarget
    run_motif_enrichment_cistarget(
  File "/home/michal.kubacki/Downloads/scenicplus/src/scenicplus/cli/commands.py", line 156, in run_motif_enrichment_cistarget
    cistarget_results: List[cisTarget] = joblib.Parallel(
                                         ^^^^^^^^^^^^^^^^
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/parallel.py", line 1952, in __call__
    return output if self.return_generator else list(output)
                                                ^^^^^^^^^^^^
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/parallel.py", line 1595, in _get_outputs
    yield from self._retrieve()
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/parallel.py", line 1699, in _retrieve
    self._raise_error_fast()
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/parallel.py", line 1734, in _raise_error_fast
    error_job.get_result(self.timeout)
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/parallel.py", line 736, in get_result
    return self._return_or_raise()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/parallel.py", line 754, in _return_or_raise
    raise self._result
joblib.externals.loky.process_executor.TerminatedWorkerError: A worker process managed by the executor was unexpectedly terminated. This could be caused by a segmentation fault while calling the function or by an excessive memory usage causing the Operating System to kill the worker.

The exit codes of the workers are {SIGKILL(-9)}
[Thu Jul 18 21:45:08 2024]
Error in rule motif_enrichment_cistarget:
    jobid: 9
    input: /group/testa/michal.kubacki/herring/output_hg19_all_cells/region_sets, /group/testa/michal.kubacki/herring/output_hg19_all_cells/cistarget_motif_dataset.regions_vs_motifs.rankings.feather, /group/testa/michal.kubacki/herring/scenic_input/motifs-v10nr_clust-nr.hgnc-m0.001-o0.0.tbl
    output: /group/testa/michal.kubacki/herring/scenic_all_cells/ctx_results.hdf5, /group/testa/michal.kubacki/herring/scenic_all_cells/ctx_results.html
    shell:
        
            scenicplus grn_inference motif_enrichment_cistarget                 --region_set_folder /group/testa/michal.kubacki/herring/output_hg19_all_cells/region_sets                 --cistarget_db_fname /group/testa/michal.kubacki/herring/output_hg19_all_cells/cistarget_motif_dataset.regions_vs_motifs.rankings.feather                 --output_fname_cistarget_result /group/testa/michal.kubacki/herring/scenic_all_cells/ctx_results.hdf5                 --temp_dir /group/testa/michal.kubacki/herring/output_hg19_all_cells/tmp                 --species homo_sapiens                 --fr_overlap_w_ctx_db 0.4                 --auc_threshold 0.005                 --nes_threshold 3.0                 --rank_threshold 0.05                 --path_to_motif_annotations /group/testa/michal.kubacki/herring/scenic_input/motifs-v10nr_clust-nr.hgnc-m0.001-o0.0.tbl                 --annotation_version v10nr_clust                 --motif_similarity_fdr 0.001                 --orthologous_identity_threshold 0.0                 --annotations_to_use Direct_annot Orthology_annot                 --write_html                 --output_fname_cistarget_html /group/testa/michal.kubacki/herring/scenic_all_cells/ctx_results.html                 --n_cpu 96
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: .snakemake/log/2024-07-18T212616.145327.snakemake.log
WorkflowError:
At least one job did not complete successfully.
slurmstepd: error: Detected 1 oom-kill event(s) in StepId=13716218.batch. Some of your processes may have been killed by the cgroup out-of-memory handler.
slurmstepd: error: _cgroup_procs_check: failed on path /sys/fs/cgroup/memory/slurm/uid_10666/job_13716218/step_batch/cgroup.procs: No such file or directory
slurmstepd: error: unable to read '/sys/fs/cgroup/memory/slurm/uid_10666/job_13716218/step_batch/cgroup.procs'
