INFO: localdir at /localscratch/13571883.michal.kubacki
INFO: your job will run on local system.
root_dir: /group/testa/michal.kubacki/herring
out_dir: /group/testa/michal.kubacki/herring/output_hg19_all_cells
in_dir: /group/testa/michal.kubacki/herring/data
tmp_dir: /group/testa/michal.kubacki/herring/tmp
All fragments: {'ga22': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138510_RL2366_ga22_snATAC_fragments.tsv.gz', '1y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138526_RL2209_1y_snATAC_fragments.tsv.gz', '14y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138542_RL2372_14y_snATAC_fragments.tsv.gz', 'ga24': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138512_RL2207_ga24_snATAC_fragments.tsv.gz', '2y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138529_RL1784_2y_snATAC_fragments.tsv.gz', '16y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138544_RL1785_16y_snATAC_fragments.tsv.gz', '1m': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138515_RL2367_1m_snATAC_fragments.tsv.gz', '4y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138532_RL2210_4y_snATAC_fragments.tsv.gz', '20y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138548_RL2085_20y_snATAC_fragments.tsv.gz', '3m': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138518_RL1914_3m_snATAC_fragments.tsv.gz', '6y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138534_RL2364_6y_snATAC_fragments.tsv.gz', '25y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138550_RL2369_25y_snATAC_fragments.tsv.gz', '6m': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138521_RL2208_6m_snATAC_fragments.tsv.gz', '8y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138536_RL1994_8y_snATAC_fragments.tsv.gz', '40y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138552_RL2373_40y_snATAC_fragments.tsv.gz', '10m': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138523_RL2371_10m_snATAC_fragments.tsv.gz', '10y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138539_RL2368_10y_snATAC_fragments.tsv.gz'}
Selected fragments: ['1m', '3m', '6m', '10m', '1y', '2y', '4y', '6y', '10y', '16y', '20y', '40y', 'ga22', 'ga24']
(87339, 24)
(77446, 24)
v3    73965
v2     3481
Name: chem, dtype: int64
1.0    77446
Name: PassQC, dtype: int64
(73965, 24)
(63229, 24)
(63229, 25)
L2-3_CUX2: 7122
L5-6_TLE4: 3761
L4_RORB: 9157
L5-6_THEMIS: 2937
PN_dev: 4963
MGE_dev: 1801
SST: 3700
PV: 1648
Micro: 3647
OPC: 5546
VIP: 2037
CGE_dev: 358
Vas: 973
Oligo: 6340
Astro: 9212
ID2: 27
L2-3_CUX2: 7122
L5-6_TLE4: 3761
L4_RORB: 9157
L5-6_THEMIS: 2937
PN_dev: 4963
MGE_dev: 1801
SST: 3700
PV: 1648
Micro: 3647
OPC: 5546
VIP: 2037
CGE_dev: 358
Vas: 973
Oligo: 6340
Astro: 9212
ID2: 27
L2-3_CUX2: 7122
L5-6_TLE4: 3761
L4_RORB: 9157
L5-6_THEMIS: 2937
PN_dev: 4963
MGE_dev: 1801
SST: 3700
PV: 1648
Micro: 3647
OPC: 5546
VIP: 2037
Vas: 973
Oligo: 6340
Astro: 9212
2024-07-17 06:26:53,453 cisTopic     INFO     Splitting fragments by cell type.
Traceback (most recent call last):
  File "/home/michal.kubacki/Githubs/Re-MEND/code/External_Datasets/GeneSet_Derivation/Herring_scenic/PycisTopic_Scenic/train_model_before.py", line 284, in <module>
    paths = export_pseudobulk(
            ^^^^^^^^^^^^^^^^^^
  File "/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pycisTopic/pseudobulk_peak_calling.py", line 162, in export_pseudobulk
    split_fragment_files_by_cell_type(
  File "/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/scatac_fragment_tools/library/split/split_fragments_by_cell_type.py", line 92, in split_fragment_files_by_cell_type
    raise ValueError(f"Fragment file {path_to_fragment_file} does not exist.")
ValueError: Fragment file /home/michal.kubacki/Githubs/Re-MEND/code/External_Datasets/GeneSet_Derivation/Herring_scenic/Main_analysis/Exicatory_all/tmp/6y/Vas.fragments.tsv.gz does not exist.
slurmstepd: error: _cgroup_procs_check: failed on path /sys/fs/cgroup/memory/slurm/uid_10666/job_13571883/step_batch/cgroup.procs: No such file or directory
slurmstepd: error: unable to read '/sys/fs/cgroup/memory/slurm/uid_10666/job_13571883/step_batch/cgroup.procs'
