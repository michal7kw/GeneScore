INFO: localdir at /localscratch/13716226.michal.kubacki
INFO: your job will run on local system.
Assuming unrestricted shared filesystem usage for local execution.
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 96
Rules claiming more threads will be scaled down.
Job stats:
job                            count
---------------------------  -------
AUCell_direct                      1
AUCell_extended                    1
all                                1
download_genome_annotations        1
eGRN_direct                        1
eGRN_extended                      1
get_search_space                   1
motif_enrichment_cistarget         1
motif_enrichment_dem               1
prepare_GEX_ACC_multiome           1
prepare_menr                       1
region_to_gene                     1
scplus_mudata                      1
tf_to_gene                         1
total                             14

Select jobs to execute...
Execute 3 jobs...

[Thu Jul 18 21:27:58 2024]
localrule prepare_GEX_ACC_multiome:
    input: /group/testa/michal.kubacki/herring/output_hg19_all_excitatory_all_ages/cistopic_obj.pkl, /group/testa/michal.kubacki/herring/output_hg19_all_excitatory_all_ages/modified_adata.h5ad
    output: /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/ACC_GEX.h5mu
    jobid: 2
    reason: Forced execution
    resources: tmpdir=/localscratch/13716226.michal.kubacki


[Thu Jul 18 21:27:58 2024]
localrule download_genome_annotations:
    output: /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/genome_annotation.tsv, /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/chromsizes.tsv
    jobid: 8
    reason: Forced execution
    resources: tmpdir=/localscratch/13716226.michal.kubacki


[Thu Jul 18 21:27:59 2024]
localrule motif_enrichment_cistarget:
    input: /group/testa/michal.kubacki/herring/output_hg19_all_excitatory_all_ages/region_sets, /scratch/michal.kubacki/herring/output_hg19_all_excitatory_all_ages/cistarget_motif_dataset.regions_vs_motifs.rankings.feather, /group/testa/michal.kubacki/herring/scenic_input/motifs-v10nr_clust-nr.hgnc-m0.001-o0.0.tbl
    output: /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/ctx_results.hdf5, /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/ctx_results.html
    jobid: 9
    reason: Forced execution
    threads: 32
    resources: tmpdir=/localscratch/13716226.michal.kubacki

2024-07-18 21:31:58,392 SCENIC+      INFO     Reading region sets from: /group/testa/michal.kubacki/herring/output_hg19_all_excitatory_all_ages/region_sets
2024-07-18 21:31:58,411 SCENIC+      INFO     Reading all .bed files in: Topics_top_3k
2024-07-18 21:31:58,788 SCENIC+      INFO     Reading cisTopic object.
2024-07-18 21:32:01,028 SCENIC+      INFO     Reading all .bed files in: DARs_cell_type
2024-07-18 21:32:01,504 SCENIC+      INFO     Reading all .bed files in: Topics_otsu
2024-07-18 21:34:36,739 Download gene annotation INFO     Using genome: GRCh38.p14
2024-07-18 21:34:38,218 Download gene annotation INFO     Found corresponding genome Id 51 on NCBI
2024-07-18 21:34:42,827 Download gene annotation INFO     Found corresponding assembly Id 11968211 on NCBI
2024-07-18 21:34:46,761 Download gene annotation INFO     Downloading assembly information from: ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/001/405/GCF_000001405.40_GRCh38.p14/GCF_000001405.40_GRCh38.p14_assembly_report.txt
2024-07-18 21:34:53,576 SCENIC+      INFO     Reading gene expression AnnData.
2024-07-18 21:35:19,195 Download gene annotation INFO     Found following assembled molecules (chromosomes): 
	1
	2
	3
	4
	5
	6
	7
	8
	9
	10
	11
	12
	13
	14
	15
	16
	17
	18
	19
	20
	21
	22
	X
	Y
	MT
2024-07-18 21:35:19,248 Download gene annotation INFO     Converting chromosomes names to UCSC style as follows: 
	Original	UCSC
	1	chr1
	2	chr2
	3	chr3
	4	chr4
	5	chr5
	6	chr6
	7	chr7
	8	chr8
	9	chr9
	10	chr10
	11	chr11
	12	chr12
	13	chr13
	14	chr14
	15	chr15
	16	chr16
	17	chr17
	18	chr18
	19	chr19
	20	chr20
	21	chr21
	22	chr22
	X	chrX
	Y	chrY
	MT	chrM
2024-07-18 21:35:19,262 SCENIC+      INFO     Saving chromosome sizes to: /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/chromsizes.tsv
2024-07-18 21:35:21,225 SCENIC+      INFO     Saving genome annotation to: /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/genome_annotation.tsv
2024-07-18 21:36:00,922 Ingesting multiome data INFO     Found 78 multiome cells.
2024-07-18 21:36:01,122 cisTopic     INFO     Imputing region accessibility
2024-07-18 21:36:01,122 cisTopic     INFO     Impute region accessibility for regions 0-20000
2024-07-18 21:36:01,309 cisTopic     INFO     Impute region accessibility for regions 20000-40000
2024-07-18 21:36:01,318 cisTopic     INFO     Impute region accessibility for regions 40000-60000
2024-07-18 21:36:01,326 cisTopic     INFO     Impute region accessibility for regions 60000-80000
2024-07-18 21:36:01,335 cisTopic     INFO     Impute region accessibility for regions 80000-100000
2024-07-18 21:36:01,344 cisTopic     INFO     Impute region accessibility for regions 100000-120000
2024-07-18 21:36:01,352 cisTopic     INFO     Impute region accessibility for regions 120000-140000
2024-07-18 21:36:01,361 cisTopic     INFO     Impute region accessibility for regions 140000-160000
2024-07-18 21:36:01,370 cisTopic     INFO     Impute region accessibility for regions 160000-180000
2024-07-18 21:36:01,378 cisTopic     INFO     Impute region accessibility for regions 180000-200000
2024-07-18 21:36:01,387 cisTopic     INFO     Impute region accessibility for regions 200000-220000
2024-07-18 21:36:01,395 cisTopic     INFO     Impute region accessibility for regions 220000-240000
2024-07-18 21:36:01,403 cisTopic     INFO     Impute region accessibility for regions 240000-260000
2024-07-18 21:36:01,412 cisTopic     INFO     Impute region accessibility for regions 260000-280000
2024-07-18 21:36:01,421 cisTopic     INFO     Impute region accessibility for regions 280000-300000
2024-07-18 21:36:01,429 cisTopic     INFO     Impute region accessibility for regions 300000-320000
2024-07-18 21:36:01,438 cisTopic     INFO     Impute region accessibility for regions 320000-340000
2024-07-18 21:36:01,440 cisTopic     INFO     Done!
... storing 'predictedGroup' as categorical
... storing 'pycisTopic_leiden_10_0.6' as categorical
... storing 'age_mapped' as categorical
... storing 'major_clust' as categorical
... storing 'age' as categorical
... storing 'chem' as categorical
... storing 'pycisTopic_leiden_10_1.2' as categorical
... storing 'sample_id' as categorical
... storing 'predictedCell' as categorical
... storing 'Clusters' as categorical
... storing 'old_index' as categorical
... storing 'pycisTopic_leiden_10_3' as categorical
... storing 'Chromosome' as categorical
[Thu Jul 18 21:42:05 2024]
Finished job 8.
1 of 14 steps (7%) done
Select jobs to execute...
Execute 1 jobs...

[Thu Jul 18 21:42:05 2024]
localrule motif_enrichment_dem:
    input: /group/testa/michal.kubacki/herring/output_hg19_all_excitatory_all_ages/region_sets, /scratch/michal.kubacki/herring/output_hg19_all_excitatory_all_ages/cistarget_motif_dataset.regions_vs_motifs.scores.feather, /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/genome_annotation.tsv, /group/testa/michal.kubacki/herring/scenic_input/motifs-v10nr_clust-nr.hgnc-m0.001-o0.0.tbl
    output: /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/dem_results.hdf5, /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/dem_results.html
    jobid: 7
    reason: Forced execution
    threads: 32
    resources: tmpdir=/localscratch/13716226.michal.kubacki

[Thu Jul 18 21:42:11 2024]
Finished job 2.
2 of 14 steps (14%) done
Select jobs to execute...
Execute 1 jobs...

[Thu Jul 18 21:42:11 2024]
localrule get_search_space:
    input: /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/ACC_GEX.h5mu, /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/genome_annotation.tsv, /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/chromsizes.tsv
    output: /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/search_space.tsv
    jobid: 11
    reason: Forced execution
    resources: tmpdir=/localscratch/13716226.michal.kubacki

2024-07-18 22:12:51,202 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:51,204 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:51,207 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:51,218 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:51,522 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:51,603 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:51,762 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:52,209 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:53,209 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:53,486 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:53,703 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:54,016 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:54,121 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:54,669 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:55,039 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:55,042 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:55,069 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:55,123 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:55,134 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:55,144 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:55,160 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:55,173 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:55,181 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:55,198 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:55,200 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:55,202 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:55,204 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:55,213 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:55,236 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:55,274 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:55,275 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:55,396 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:12:59,386 SCENIC+      INFO     Reading region sets from: /group/testa/michal.kubacki/herring/output_hg19_all_excitatory_all_ages/region_sets
2024-07-18 22:12:59,411 SCENIC+      INFO     Reading all .bed files in: Topics_top_3k
2024-07-18 22:13:00,281 SCENIC+      INFO     Reading all .bed files in: DARs_cell_type
2024-07-18 22:13:00,354 SCENIC+      INFO     Reading all .bed files in: Topics_otsu
2024-07-18 22:13:00,932 SCENIC+      INFO     Reading data
/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
2024-07-18 22:13:10,947 Get search space INFO     Extending promoter annotation to 10 bp upstream and 10 downstream
2024-07-18 22:13:11,869 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic34 which has 3000 regions
2024-07-18 22:13:11,890 Get search space INFO     Extending search space to:
            						150000 bp downstream of the end of the gene.
            						150000 bp upstream of the start of the gene.
2024-07-18 22:13:11,921 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic25 which has 3000 regions
2024-07-18 22:13:12,158 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic17 which has 3000 regions
2024-07-18 22:13:12,230 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic28 which has 3000 regions
2024-07-18 22:13:12,252 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic16 which has 3000 regions
2024-07-18 22:13:12,252 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic39 which has 3000 regions
2024-07-18 22:13:12,271 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic23 which has 3000 regions
2024-07-18 22:13:12,284 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic5 which has 3000 regions
2024-07-18 22:13:12,286 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic10 which has 3000 regions
2024-07-18 22:13:12,295 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic8 which has 3000 regions
2024-07-18 22:13:12,305 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic19 which has 3000 regions
2024-07-18 22:13:12,309 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic6 which has 3000 regions
2024-07-18 22:13:12,320 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic7 which has 3000 regions
2024-07-18 22:13:12,337 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic40 which has 3000 regions
2024-07-18 22:13:12,341 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic4 which has 3000 regions
2024-07-18 22:13:12,348 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic31 which has 3000 regions
2024-07-18 22:13:12,362 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic12 which has 3000 regions
2024-07-18 22:13:12,373 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic18 which has 3000 regions
2024-07-18 22:13:12,383 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic27 which has 3000 regions
2024-07-18 22:13:12,385 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic38 which has 3000 regions
2024-07-18 22:13:12,400 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic36 which has 3000 regions
2024-07-18 22:13:12,408 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic33 which has 3000 regions
2024-07-18 22:13:12,443 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic3 which has 3000 regions
2024-07-18 22:13:12,458 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic15 which has 3000 regions
2024-07-18 22:13:12,461 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic11 which has 3000 regions
2024-07-18 22:13:12,504 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic30 which has 3000 regions
2024-07-18 22:13:12,505 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic29 which has 3000 regions
2024-07-18 22:13:12,505 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic32 which has 3000 regions
2024-07-18 22:13:12,517 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic37 which has 3000 regions
2024-07-18 22:13:12,524 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic14 which has 3000 regions
2024-07-18 22:13:13,107 Get search space INFO     Intersecting with regions.
2024-07-18 22:13:13,388 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic13 which has 3000 regions
2024-07-18 22:13:13,451 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic21 which has 3000 regions
2024-07-18 22:13:15,031 Get search space INFO     Calculating distances from region to gene
2024-07-18 22:13:26,047 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic34
2024-07-18 22:13:27,827 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic39
2024-07-18 22:13:28,430 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic11
2024-07-18 22:13:30,418 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic34
2024-07-18 22:13:30,874 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic6
2024-07-18 22:13:31,045 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic39
2024-07-18 22:13:31,144 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic11
2024-07-18 22:13:31,650 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic27
2024-07-18 22:13:32,100 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:32,293 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:32,460 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic17
2024-07-18 22:13:32,661 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic19
2024-07-18 22:13:32,690 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic21
2024-07-18 22:13:32,934 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic8
2024-07-18 22:13:33,169 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic23
2024-07-18 22:13:33,175 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic5
2024-07-18 22:13:33,456 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic6
2024-07-18 22:13:33,479 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:33,481 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic33
2024-07-18 22:13:33,505 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic40
2024-07-18 22:13:33,513 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic38
2024-07-18 22:13:34,040 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic27
2024-07-18 22:13:34,268 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic13
2024-07-18 22:13:34,353 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic36
2024-07-18 22:13:34,409 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic4
2024-07-18 22:13:34,515 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:34,597 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic17
2024-07-18 22:13:34,667 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic21
2024-07-18 22:13:34,679 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic19
2024-07-18 22:13:34,692 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:34,768 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic25
2024-07-18 22:13:34,976 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic28
2024-07-18 22:13:35,015 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:35,017 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:35,209 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:35,240 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic8
2024-07-18 22:13:35,367 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic31
2024-07-18 22:13:35,499 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic33
2024-07-18 22:13:35,545 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic5
2024-07-18 22:13:35,604 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic40
2024-07-18 22:13:35,605 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic16
2024-07-18 22:13:35,648 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic38
2024-07-18 22:13:35,670 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic7
2024-07-18 22:13:35,687 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic14
2024-07-18 22:13:35,701 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic3
2024-07-18 22:13:35,816 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic23
2024-07-18 22:13:35,841 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic32
2024-07-18 22:13:35,850 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic37
2024-07-18 22:13:35,921 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:35,975 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic18
2024-07-18 22:13:36,047 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:36,093 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic30
2024-07-18 22:13:36,147 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:36,211 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:36,287 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:36,300 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic10
2024-07-18 22:13:36,346 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic12
2024-07-18 22:13:36,357 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic29
2024-07-18 22:13:36,414 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic15
2024-07-18 22:13:36,457 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:36,486 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic13
2024-07-18 22:13:36,590 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic4
2024-07-18 22:13:36,852 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic36
2024-07-18 22:13:36,870 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:37,144 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic25
2024-07-18 22:13:37,352 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:37,647 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic31
2024-07-18 22:13:37,828 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:38,048 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic14
2024-07-18 22:13:38,119 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic3
2024-07-18 22:13:38,179 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic7
2024-07-18 22:13:38,288 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic32
2024-07-18 22:13:38,335 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:38,532 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic30
2024-07-18 22:13:38,708 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic12
2024-07-18 22:13:38,729 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic28
2024-07-18 22:13:38,743 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:38,851 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic29
2024-07-18 22:13:38,947 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic10
2024-07-18 22:13:39,118 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic16
2024-07-18 22:13:39,196 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic15
2024-07-18 22:13:39,262 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:39,434 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:39,569 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:39,666 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:39,749 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic37
2024-07-18 22:13:39,804 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:39,926 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:40,103 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:40,409 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic18
2024-07-18 22:13:40,513 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:41,032 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:41,476 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:41,989 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:42,464 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:44,301 cisTarget    INFO     Reading cisTarget database
2024-07-18 22:13:45,461 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic20 which has 3000 regions
2024-07-18 22:13:48,337 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic1 which has 3000 regions
2024-07-18 22:13:49,273 cisTarget    INFO     Running cisTarget for Topics_otsu_Topic39 which has 4399 regions
2024-07-18 22:13:49,925 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic9 which has 3000 regions
2024-07-18 22:13:50,421 cisTarget    INFO     Running cisTarget for Topics_otsu_Topic18 which has 4634 regions
2024-07-18 22:13:51,295 cisTarget    INFO     Running cisTarget for DARs_cell_type_PN_dev which has 2789 regions
2024-07-18 22:13:51,345 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic35 which has 3000 regions
2024-07-18 22:13:51,493 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic20
2024-07-18 22:13:54,875 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic26 which has 3000 regions
2024-07-18 22:13:54,875 cisTarget    INFO     Running cisTarget for Topics_top_3k_Topic24 which has 3000 regions
2024-07-18 22:13:54,880 cisTarget    INFO     Running cisTarget for Topics_otsu_Topic31 which has 5315 regions
2024-07-18 22:13:55,880 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic1
2024-07-18 22:13:56,299 cisTarget    INFO     Annotating motifs for Topics_top_3k_Topic9
2024-07-18 22:13:56,583 cisTarget    INFO     Annotating motifs for Topics_otsu_Topic39
2024-07-18 22:13:57,245 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic20
2024-07-18 22:13:58,315 cisTarget    INFO     Getting cistromes for Topics_top_3k_Topic9
Traceback (most recent call last):
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/bin/scenicplus", line 33, in <module>
    sys.exit(load_entry_point('scenicplus', 'console_scripts', 'scenicplus')())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/michal.kubacki/Downloads/scenicplus/src/scenicplus/cli/scenicplus.py", line 1137, in main
    args.func(args)
  File "/home/michal.kubacki/Downloads/scenicplus/src/scenicplus/cli/scenicplus.py", line 386, in motif_enrichment_cistarget
    run_motif_enrichment_cistarget(
  File "/home/michal.kubacki/Downloads/scenicplus/src/scenicplus/cli/commands.py", line 156, in run_motif_enrichment_cistarget
    cistarget_results: List[cisTarget] = joblib.Parallel(
                                         ^^^^^^^^^^^^^^^^
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/parallel.py", line 1952, in __call__
    return output if self.return_generator else list(output)
                                                ^^^^^^^^^^^^
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/parallel.py", line 1595, in _get_outputs
    yield from self._retrieve()
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/parallel.py", line 1699, in _retrieve
    self._raise_error_fast()
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/parallel.py", line 1734, in _raise_error_fast
    error_job.get_result(self.timeout)
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/parallel.py", line 736, in get_result
    return self._return_or_raise()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/parallel.py", line 754, in _return_or_raise
    raise self._result
joblib.externals.loky.process_executor.TerminatedWorkerError: A worker process managed by the executor was unexpectedly terminated. This could be caused by a segmentation fault while calling the function or by an excessive memory usage causing the Operating System to kill the worker.

The exit codes of the workers are {SIGKILL(-9)}
2024-07-18 22:14:14,500 Get search space INFO     Imploding multiple entries per region and gene
[Thu Jul 18 22:14:19 2024]
Error in rule motif_enrichment_cistarget:
    jobid: 9
    input: /group/testa/michal.kubacki/herring/output_hg19_all_excitatory_all_ages/region_sets, /scratch/michal.kubacki/herring/output_hg19_all_excitatory_all_ages/cistarget_motif_dataset.regions_vs_motifs.rankings.feather, /group/testa/michal.kubacki/herring/scenic_input/motifs-v10nr_clust-nr.hgnc-m0.001-o0.0.tbl
    output: /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/ctx_results.hdf5, /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/ctx_results.html
    shell:
        
            scenicplus grn_inference motif_enrichment_cistarget                 --region_set_folder /group/testa/michal.kubacki/herring/output_hg19_all_excitatory_all_ages/region_sets                 --cistarget_db_fname /scratch/michal.kubacki/herring/output_hg19_all_excitatory_all_ages/cistarget_motif_dataset.regions_vs_motifs.rankings.feather                 --output_fname_cistarget_result /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/ctx_results.hdf5                 --temp_dir /group/testa/michal.kubacki/herring/output_hg19_all_excitatory_all_ages/tmp                 --species homo_sapiens                 --fr_overlap_w_ctx_db 0.4                 --auc_threshold 0.005                 --nes_threshold 3.0                 --rank_threshold 0.05                 --path_to_motif_annotations /group/testa/michal.kubacki/herring/scenic_input/motifs-v10nr_clust-nr.hgnc-m0.001-o0.0.tbl                 --annotation_version v10nr_clust                 --motif_similarity_fdr 0.001                 --orthologous_identity_threshold 0.0                 --annotations_to_use Direct_annot Orthology_annot                 --write_html                 --output_fname_cistarget_html /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/ctx_results.html                 --n_cpu 32
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

2024-07-18 22:15:54,069 SCENIC+      INFO     Writing search space to: /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/search_space.tsv
[Thu Jul 18 22:15:57 2024]
Finished job 11.
3 of 14 steps (21%) done
2024-07-18 22:21:48,893 DEM          INFO     Running DEM for Topics_top_3k_Topic7_vs_all
2024-07-18 22:21:48,894 DEM          INFO     Running DEM for Topics_top_3k_Topic30_vs_all
2024-07-18 22:21:48,897 DEM          INFO     Running DEM for Topics_top_3k_Topic10_vs_all
2024-07-18 22:21:48,898 DEM          INFO     Running DEM for Topics_top_3k_Topic40_vs_all
2024-07-18 22:21:48,905 DEM          INFO     Running DEM for Topics_top_3k_Topic12_vs_all
2024-07-18 22:21:48,905 DEM          INFO     Running DEM for Topics_top_3k_Topic17_vs_all
2024-07-18 22:21:48,906 DEM          INFO     Running DEM for Topics_top_3k_Topic4_vs_all
2024-07-18 22:21:48,968 DEM          INFO     Running DEM for Topics_top_3k_Topic21_vs_all
2024-07-18 22:21:49,066 DEM          INFO     Running DEM for Topics_top_3k_Topic6_vs_all
2024-07-18 22:21:49,076 DEM          INFO     Running DEM for Topics_top_3k_Topic11_vs_all
2024-07-18 22:21:49,078 DEM          INFO     Running DEM for Topics_top_3k_Topic32_vs_all
2024-07-18 22:21:49,080 DEM          INFO     Running DEM for Topics_top_3k_Topic29_vs_all
2024-07-18 22:21:49,094 DEM          INFO     Running DEM for Topics_top_3k_Topic5_vs_all
2024-07-18 22:21:49,107 DEM          INFO     Running DEM for Topics_top_3k_Topic13_vs_all
2024-07-18 22:21:49,112 DEM          INFO     Running DEM for Topics_top_3k_Topic18_vs_all
2024-07-18 22:21:49,126 DEM          INFO     Running DEM for Topics_top_3k_Topic34_vs_all
2024-07-18 22:21:49,152 DEM          INFO     Running DEM for Topics_top_3k_Topic19_vs_all
2024-07-18 22:21:49,185 DEM          INFO     Running DEM for Topics_top_3k_Topic16_vs_all
2024-07-18 22:21:49,198 DEM          INFO     Running DEM for Topics_top_3k_Topic38_vs_all
2024-07-18 22:21:49,198 DEM          INFO     Running DEM for Topics_top_3k_Topic3_vs_all
2024-07-18 22:21:49,215 DEM          INFO     Running DEM for Topics_top_3k_Topic23_vs_all
2024-07-18 22:21:49,252 DEM          INFO     Running DEM for Topics_top_3k_Topic15_vs_all
2024-07-18 22:21:49,259 DEM          INFO     Running DEM for Topics_top_3k_Topic36_vs_all
2024-07-18 22:21:49,267 DEM          INFO     Running DEM for Topics_top_3k_Topic14_vs_all
2024-07-18 22:21:49,282 DEM          INFO     Running DEM for Topics_top_3k_Topic28_vs_all
2024-07-18 22:21:49,314 DEM          INFO     Running DEM for Topics_top_3k_Topic31_vs_all
2024-07-18 22:21:49,317 DEM          INFO     Running DEM for Topics_top_3k_Topic8_vs_all
2024-07-18 22:21:49,349 DEM          INFO     Running DEM for Topics_top_3k_Topic33_vs_all
2024-07-18 22:21:49,390 DEM          INFO     Running DEM for Topics_top_3k_Topic27_vs_all
2024-07-18 22:21:49,529 DEM          INFO     Running DEM for Topics_top_3k_Topic25_vs_all
2024-07-18 22:21:49,536 DEM          INFO     Running DEM for Topics_top_3k_Topic39_vs_all
2024-07-18 22:21:49,672 DEM          INFO     Running DEM for Topics_top_3k_Topic37_vs_all
2024-07-18 22:22:19,666 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:19,797 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:19,898 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:20,121 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:20,240 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:20,314 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:20,426 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:20,428 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:20,437 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:20,537 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:20,563 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:20,579 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:20,629 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:20,676 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:20,677 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:20,685 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:20,799 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:20,802 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:20,824 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:20,831 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:20,876 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:20,908 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:21,013 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:21,024 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:21,028 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:21,045 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:21,062 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:21,153 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:21,303 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:21,305 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:21,370 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:21,400 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:25,901 DEM          INFO     Running DEM for Topics_top_3k_Topic9_vs_all
2024-07-18 22:22:26,099 DEM          INFO     Running DEM for Topics_top_3k_Topic20_vs_all
2024-07-18 22:22:26,216 DEM          INFO     Running DEM for Topics_top_3k_Topic1_vs_all
2024-07-18 22:22:26,548 DEM          INFO     Running DEM for Topics_top_3k_Topic35_vs_all
2024-07-18 22:22:26,723 DEM          INFO     Running DEM for DARs_cell_type_L4_RORB_vs_all
2024-07-18 22:22:26,765 DEM          INFO     Running DEM for Topics_top_3k_Topic2_vs_all
2024-07-18 22:22:27,099 DEM          INFO     Running DEM for Topics_top_3k_Topic22_vs_all
2024-07-18 22:22:27,334 DEM          INFO     Running DEM for DARs_cell_type_L5-6_THEMIS_vs_all
2024-07-18 22:22:27,520 DEM          INFO     Running DEM for DARs_cell_type_L2-3_CUX2_vs_all
2024-07-18 22:22:27,620 DEM          INFO     Running DEM for DARs_cell_type_PN_dev_vs_all
2024-07-18 22:22:27,657 DEM          INFO     Running DEM for DARs_cell_type_L5-6_TLE4_vs_all
2024-07-18 22:22:27,969 DEM          INFO     Running DEM for Topics_top_3k_Topic26_vs_all
2024-07-18 22:22:28,133 DEM          INFO     Running DEM for Topics_top_3k_Topic24_vs_all
2024-07-18 22:22:29,709 DEM          INFO     Running DEM for Topics_otsu_Topic23_vs_all
2024-07-18 22:22:30,475 DEM          INFO     Running DEM for Topics_otsu_Topic16_vs_all
2024-07-18 22:22:30,881 DEM          INFO     Running DEM for Topics_otsu_Topic6_vs_all
2024-07-18 22:22:30,917 DEM          INFO     Running DEM for Topics_otsu_Topic11_vs_all
2024-07-18 22:22:30,941 DEM          INFO     Running DEM for Topics_otsu_Topic37_vs_all
2024-07-18 22:22:30,958 DEM          INFO     Running DEM for Topics_otsu_Topic3_vs_all
2024-07-18 22:22:30,985 DEM          INFO     Running DEM for Topics_otsu_Topic25_vs_all
2024-07-18 22:22:31,167 DEM          INFO     Running DEM for Topics_otsu_Topic30_vs_all
2024-07-18 22:22:31,250 DEM          INFO     Running DEM for Topics_otsu_Topic40_vs_all
2024-07-18 22:22:31,387 DEM          INFO     Running DEM for Topics_otsu_Topic19_vs_all
2024-07-18 22:22:31,770 DEM          INFO     Running DEM for Topics_otsu_Topic39_vs_all
2024-07-18 22:22:31,816 DEM          INFO     Running DEM for Topics_otsu_Topic18_vs_all
2024-07-18 22:22:31,954 DEM          INFO     Running DEM for Topics_otsu_Topic33_vs_all
2024-07-18 22:22:32,195 DEM          INFO     Running DEM for Topics_otsu_Topic10_vs_all
2024-07-18 22:22:32,199 DEM          INFO     Running DEM for Topics_otsu_Topic17_vs_all
2024-07-18 22:22:32,401 DEM          INFO     Running DEM for Topics_otsu_Topic31_vs_all
2024-07-18 22:22:32,470 DEM          INFO     Running DEM for Topics_otsu_Topic4_vs_all
2024-07-18 22:22:32,787 DEM          INFO     Running DEM for Topics_otsu_Topic12_vs_all
2024-07-18 22:22:33,222 DEM          INFO     Running DEM for Topics_otsu_Topic36_vs_all
2024-07-18 22:22:37,928 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:40,527 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:40,987 DEM          INFO     Adding motif-to-TF annotation
/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/externals/loky/process_executor.py:752: UserWarning: A worker stopped while some jobs were given to the executor. This can be caused by a too short worker timeout or by a memory leak.
  warnings.warn(
2024-07-18 22:22:42,677 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:43,060 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:43,321 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:44,679 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:44,683 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:45,279 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:45,528 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:46,441 DEM          INFO     Adding motif-to-TF annotation
2024-07-18 22:22:48,470 DEM          INFO     Adding motif-to-TF annotation
Traceback (most recent call last):
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/bin/scenicplus", line 33, in <module>
    sys.exit(load_entry_point('scenicplus', 'console_scripts', 'scenicplus')())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/michal.kubacki/Downloads/scenicplus/src/scenicplus/cli/scenicplus.py", line 1137, in main
    args.func(args)
  File "/home/michal.kubacki/Downloads/scenicplus/src/scenicplus/cli/scenicplus.py", line 586, in motif_enrichment_dem
    run_motif_enrichment_dem(
  File "/home/michal.kubacki/Downloads/scenicplus/src/scenicplus/cli/commands.py", line 319, in run_motif_enrichment_dem
    dem_results: List[DEM] = joblib.Parallel(
                             ^^^^^^^^^^^^^^^^
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/parallel.py", line 1952, in __call__
    return output if self.return_generator else list(output)
                                                ^^^^^^^^^^^^
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/parallel.py", line 1595, in _get_outputs
    yield from self._retrieve()
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/parallel.py", line 1699, in _retrieve
    self._raise_error_fast()
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/parallel.py", line 1734, in _raise_error_fast
    error_job.get_result(self.timeout)
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/parallel.py", line 736, in get_result
    return self._return_or_raise()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/michal.kubacki/miniconda3/envs/scenicplusnew/lib/python3.11/site-packages/joblib/parallel.py", line 754, in _return_or_raise
    raise self._result
joblib.externals.loky.process_executor.TerminatedWorkerError: A worker process managed by the executor was unexpectedly terminated. This could be caused by a segmentation fault while calling the function or by an excessive memory usage causing the Operating System to kill the worker.

The exit codes of the workers are {SIGKILL(-9), SIGKILL(-9), SIGKILL(-9)}
[Thu Jul 18 22:22:55 2024]
Error in rule motif_enrichment_dem:
    jobid: 7
    input: /group/testa/michal.kubacki/herring/output_hg19_all_excitatory_all_ages/region_sets, /scratch/michal.kubacki/herring/output_hg19_all_excitatory_all_ages/cistarget_motif_dataset.regions_vs_motifs.scores.feather, /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/genome_annotation.tsv, /group/testa/michal.kubacki/herring/scenic_input/motifs-v10nr_clust-nr.hgnc-m0.001-o0.0.tbl
    output: /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/dem_results.hdf5, /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/dem_results.html
    shell:
        
                scenicplus grn_inference motif_enrichment_dem                     --region_set_folder /group/testa/michal.kubacki/herring/output_hg19_all_excitatory_all_ages/region_sets                     --dem_db_fname /scratch/michal.kubacki/herring/output_hg19_all_excitatory_all_ages/cistarget_motif_dataset.regions_vs_motifs.scores.feather                     --output_fname_dem_result /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/dem_results.hdf5                     --temp_dir /group/testa/michal.kubacki/herring/output_hg19_all_excitatory_all_ages/tmp                     --species homo_sapiens                     --fraction_overlap_w_dem_database 0.4                     --max_bg_regions 500                     --genome_annotation /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/genome_annotation.tsv                     --balance_number_of_promoters                     --promoter_space 1000                     --adjpval_thr 0.05                     --log2fc_thr 1.0                     --mean_fg_thr 0.0                     --motif_hit_thr 3.0                     --path_to_motif_annotations /group/testa/michal.kubacki/herring/scenic_input/motifs-v10nr_clust-nr.hgnc-m0.001-o0.0.tbl                     --annotation_version v10nr_clust                     --motif_similarity_fdr 0.001                     --orthologous_identity_threshold 0.0                     --annotations_to_use Direct_annot Orthology_annot                     --write_html                     --output_fname_dem_html /group/testa/michal.kubacki/herring/scenic_all_excitatory_all_ages/dem_results.html                     --seed 666                     --n_cpu 32
            
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: .snakemake/log/2024-07-18T212757.289191.snakemake.log
WorkflowError:
At least one job did not complete successfully.
slurmstepd: error: Detected 3 oom-kill event(s) in StepId=13716226.batch. Some of your processes may have been killed by the cgroup out-of-memory handler.
slurmstepd: error: _cgroup_procs_check: failed on path /sys/fs/cgroup/memory/slurm/uid_10666/job_13716226/step_batch/cgroup.procs: No such file or directory
slurmstepd: error: unable to read '/sys/fs/cgroup/memory/slurm/uid_10666/job_13716226/step_batch/cgroup.procs'
