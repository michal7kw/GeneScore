INFO: localdir at /localscratch/13586670.michal.kubacki
INFO: your job will run on local system.
root_dir: /group/testa/michal.kubacki/herring
out_dir: /group/testa/michal.kubacki/herring/output_hg19_all_cells
in_dir: /group/testa/michal.kubacki/herring/data
tmp_dir: /group/testa/michal.kubacki/herring/tmp
All fragments: {'ga22': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138510_RL2366_ga22_snATAC_fragments.tsv.gz', '1y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138526_RL2209_1y_snATAC_fragments.tsv.gz', '14y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138542_RL2372_14y_snATAC_fragments.tsv.gz', 'ga24': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138512_RL2207_ga24_snATAC_fragments.tsv.gz', '2y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138529_RL1784_2y_snATAC_fragments.tsv.gz', '16y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138544_RL1785_16y_snATAC_fragments.tsv.gz', '1m': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138515_RL2367_1m_snATAC_fragments.tsv.gz', '4y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138532_RL2210_4y_snATAC_fragments.tsv.gz', '20y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138548_RL2085_20y_snATAC_fragments.tsv.gz', '3m': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138518_RL1914_3m_snATAC_fragments.tsv.gz', '6y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138534_RL2364_6y_snATAC_fragments.tsv.gz', '25y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138550_RL2369_25y_snATAC_fragments.tsv.gz', '6m': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138521_RL2208_6m_snATAC_fragments.tsv.gz', '8y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138536_RL1994_8y_snATAC_fragments.tsv.gz', '40y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138552_RL2373_40y_snATAC_fragments.tsv.gz', '10m': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138523_RL2371_10m_snATAC_fragments.tsv.gz', '10y': '/group/testa/michal.kubacki/herring/data/GSE168408_RAW/GSM5138539_RL2368_10y_snATAC_fragments.tsv.gz'}
Selected fragments: ['1m', '3m', '6m', '10m', '1y', '2y', '4y', '6y', '10y', '16y', '20y', '40y', 'ga22', 'ga24']
(87339, 24)
(76394, 24)
v3    72931
v2     3463
Name: chem, dtype: int64
1.0    76394
Name: PassQC, dtype: int64
(72931, 24)
(62229, 24)
(62229, 25)
L2-3_CUX2: 7122
L5-6_TLE4: 3761
L4_RORB: 9157
L5-6_THEMIS: 2937
PN_dev: 4963
MGE_dev: 1801
SST: 3700
PV: 1648
Micro: 3647
OPC: 5546
VIP: 2037
CGE_dev: 358
Oligo: 6340
Astro: 9212
L2-3_CUX2: 7122
L5-6_TLE4: 3761
L4_RORB: 9157
L5-6_THEMIS: 2937
PN_dev: 4963
MGE_dev: 1801
SST: 3700
PV: 1648
Micro: 3647
OPC: 5546
VIP: 2037
CGE_dev: 358
Oligo: 6340
Astro: 9212
L2-3_CUX2: 7122
L5-6_TLE4: 3761
L4_RORB: 9157
L5-6_THEMIS: 2937
PN_dev: 4963
MGE_dev: 1801
SST: 3700
PV: 1648
Micro: 3647
OPC: 5546
VIP: 2037
Oligo: 6340
Astro: 9212
2024-07-17 10:26:57,959 cisTopic     INFO     Splitting fragments by cell type.
2024-07-17 10:41:34,558 cisTopic     INFO     generating bigwig files
2024-07-17 10:42:36,380 cisTopic     INFO     /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bw_files/L2-3_CUX2.bw done!
2024-07-17 10:42:57,242 cisTopic     INFO     /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bw_files/L5-6_TLE4.bw done!
2024-07-17 10:44:02,281 cisTopic     INFO     /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bw_files/L4_RORB.bw done!
2024-07-17 10:44:27,810 cisTopic     INFO     /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bw_files/L5-6_THEMIS.bw done!
2024-07-17 10:45:12,428 cisTopic     INFO     /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bw_files/PN_dev.bw done!
2024-07-17 10:45:26,817 cisTopic     INFO     /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bw_files/MGE_dev.bw done!
2024-07-17 10:45:43,384 cisTopic     INFO     /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bw_files/SST.bw done!
2024-07-17 10:45:52,615 cisTopic     INFO     /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bw_files/PV.bw done!
2024-07-17 10:46:03,402 cisTopic     INFO     /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bw_files/Micro.bw done!
2024-07-17 10:46:18,239 cisTopic     INFO     /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bw_files/OPC.bw done!
2024-07-17 10:46:29,566 cisTopic     INFO     /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bw_files/VIP.bw done!
2024-07-17 10:46:49,843 cisTopic     INFO     /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bw_files/Oligo.bw done!
2024-07-17 10:47:13,287 cisTopic     INFO     /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bw_files/Astro.bw done!
2024-07-17 10:47:13,316 cisTopic     INFO     Calling peaks for L2-3_CUX2 with /home/michal.kubacki/.conda/envs/scenicplus/bin/macs2 callpeak --treatment /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bed_files/L2-3_CUX2.fragments.tsv.gz --name L2-3_CUX2  --outdir /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/MACS --format BEDPE --gsize hs --qvalue 0.05 --nomodel --shift 73 --extsize 146 --keep-dup all --call-summits --nolambda
2024-07-17 10:49:22,566 cisTopic     INFO     L2-3_CUX2 done!
2024-07-17 10:49:22,567 cisTopic     INFO     Calling peaks for L5-6_TLE4 with /home/michal.kubacki/.conda/envs/scenicplus/bin/macs2 callpeak --treatment /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bed_files/L5-6_TLE4.fragments.tsv.gz --name L5-6_TLE4  --outdir /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/MACS --format BEDPE --gsize hs --qvalue 0.05 --nomodel --shift 73 --extsize 146 --keep-dup all --call-summits --nolambda
2024-07-17 10:50:04,318 cisTopic     INFO     L5-6_TLE4 done!
2024-07-17 10:50:04,318 cisTopic     INFO     Calling peaks for L4_RORB with /home/michal.kubacki/.conda/envs/scenicplus/bin/macs2 callpeak --treatment /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bed_files/L4_RORB.fragments.tsv.gz --name L4_RORB  --outdir /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/MACS --format BEDPE --gsize hs --qvalue 0.05 --nomodel --shift 73 --extsize 146 --keep-dup all --call-summits --nolambda
2024-07-17 10:52:47,966 cisTopic     INFO     L4_RORB done!
2024-07-17 10:52:47,968 cisTopic     INFO     Calling peaks for L5-6_THEMIS with /home/michal.kubacki/.conda/envs/scenicplus/bin/macs2 callpeak --treatment /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bed_files/L5-6_THEMIS.fragments.tsv.gz --name L5-6_THEMIS  --outdir /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/MACS --format BEDPE --gsize hs --qvalue 0.05 --nomodel --shift 73 --extsize 146 --keep-dup all --call-summits --nolambda
2024-07-17 10:53:50,261 cisTopic     INFO     L5-6_THEMIS done!
2024-07-17 10:53:50,262 cisTopic     INFO     Calling peaks for PN_dev with /home/michal.kubacki/.conda/envs/scenicplus/bin/macs2 callpeak --treatment /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bed_files/PN_dev.fragments.tsv.gz --name PN_dev  --outdir /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/MACS --format BEDPE --gsize hs --qvalue 0.05 --nomodel --shift 73 --extsize 146 --keep-dup all --call-summits --nolambda
2024-07-17 10:55:33,582 cisTopic     INFO     PN_dev done!
2024-07-17 10:55:33,584 cisTopic     INFO     Calling peaks for MGE_dev with /home/michal.kubacki/.conda/envs/scenicplus/bin/macs2 callpeak --treatment /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bed_files/MGE_dev.fragments.tsv.gz --name MGE_dev  --outdir /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/MACS --format BEDPE --gsize hs --qvalue 0.05 --nomodel --shift 73 --extsize 146 --keep-dup all --call-summits --nolambda
2024-07-17 10:56:09,673 cisTopic     INFO     MGE_dev done!
2024-07-17 10:56:09,673 cisTopic     INFO     Calling peaks for SST with /home/michal.kubacki/.conda/envs/scenicplus/bin/macs2 callpeak --treatment /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bed_files/SST.fragments.tsv.gz --name SST  --outdir /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/MACS --format BEDPE --gsize hs --qvalue 0.05 --nomodel --shift 73 --extsize 146 --keep-dup all --call-summits --nolambda
2024-07-17 10:56:55,077 cisTopic     INFO     SST done!
2024-07-17 10:56:55,077 cisTopic     INFO     Calling peaks for PV with /home/michal.kubacki/.conda/envs/scenicplus/bin/macs2 callpeak --treatment /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bed_files/PV.fragments.tsv.gz --name PV  --outdir /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/MACS --format BEDPE --gsize hs --qvalue 0.05 --nomodel --shift 73 --extsize 146 --keep-dup all --call-summits --nolambda
2024-07-17 10:57:04,668 cisTopic     INFO     PV done!
2024-07-17 10:57:04,668 cisTopic     INFO     Calling peaks for Micro with /home/michal.kubacki/.conda/envs/scenicplus/bin/macs2 callpeak --treatment /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bed_files/Micro.fragments.tsv.gz --name Micro  --outdir /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/MACS --format BEDPE --gsize hs --qvalue 0.05 --nomodel --shift 73 --extsize 146 --keep-dup all --call-summits --nolambda
2024-07-17 10:57:36,826 cisTopic     INFO     Micro done!
2024-07-17 10:57:36,826 cisTopic     INFO     Calling peaks for OPC with /home/michal.kubacki/.conda/envs/scenicplus/bin/macs2 callpeak --treatment /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bed_files/OPC.fragments.tsv.gz --name OPC  --outdir /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/MACS --format BEDPE --gsize hs --qvalue 0.05 --nomodel --shift 73 --extsize 146 --keep-dup all --call-summits --nolambda
2024-07-17 10:58:10,630 cisTopic     INFO     OPC done!
2024-07-17 10:58:10,630 cisTopic     INFO     Calling peaks for VIP with /home/michal.kubacki/.conda/envs/scenicplus/bin/macs2 callpeak --treatment /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bed_files/VIP.fragments.tsv.gz --name VIP  --outdir /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/MACS --format BEDPE --gsize hs --qvalue 0.05 --nomodel --shift 73 --extsize 146 --keep-dup all --call-summits --nolambda
2024-07-17 10:58:30,954 cisTopic     INFO     VIP done!
2024-07-17 10:58:30,954 cisTopic     INFO     Calling peaks for Oligo with /home/michal.kubacki/.conda/envs/scenicplus/bin/macs2 callpeak --treatment /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bed_files/Oligo.fragments.tsv.gz --name Oligo  --outdir /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/MACS --format BEDPE --gsize hs --qvalue 0.05 --nomodel --shift 73 --extsize 146 --keep-dup all --call-summits --nolambda
2024-07-17 10:59:25,972 cisTopic     INFO     Oligo done!
2024-07-17 10:59:25,972 cisTopic     INFO     Calling peaks for Astro with /home/michal.kubacki/.conda/envs/scenicplus/bin/macs2 callpeak --treatment /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/pseudobulk_bed_files/Astro.fragments.tsv.gz --name Astro  --outdir /group/testa/michal.kubacki/herring/output_hg19_all_cells/consensus_peak_calling/MACS --format BEDPE --gsize hs --qvalue 0.05 --nomodel --shift 73 --extsize 146 --keep-dup all --call-summits --nolambda
2024-07-17 11:00:21,875 cisTopic     INFO     Astro done!
2024-07-17 11:00:21,898 cisTopic     INFO     Extending and merging peaks per class
2024-07-17 11:01:42,723 cisTopic     INFO     Normalizing peak scores
2024-07-17 11:01:43,216 cisTopic     INFO     Merging peaks
Warning! Start and End columns now have different dtypes: int64 and int32
2024-07-17 11:03:07,740 cisTopic     INFO     Done!
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pyranges/out.py:37: FutureWarning: Passing a set as an indexer is deprecated and will raise in a future version. Use a list instead.
  return pd.concat([outdf, df.get(noncanonical)], axis=1)
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/pycisTopic/plotting/qc_plot.py:340: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  fig, axs = plt.subplots(
1m:
	Using automatic threshold for unique fragments: 1202.8022688598223
	Using automatic threshold for TSS enrichment: 1.742530285948993
3m:
	Using automatic threshold for unique fragments: 1409.6979132242489
	Using automatic threshold for TSS enrichment: 1.5834907011528703
6m:
	Using automatic threshold for unique fragments: 1339.738906698545
	Using automatic threshold for TSS enrichment: 1.486449504950495
10m:
	Using automatic threshold for unique fragments: 1415.966908641344
	Using automatic threshold for TSS enrichment: 1.5211207920792078
1y:
	Using automatic threshold for unique fragments: 909.2515925477728
	Using automatic threshold for TSS enrichment: 1.5731110557626589
2y:
	Using automatic threshold for unique fragments: 1147.7603006373417
	Using automatic threshold for TSS enrichment: 1.6757426605646697
4y:
	Using automatic threshold for unique fragments: 1506.182861520546
	Using automatic threshold for TSS enrichment: 1.5950178742362109
6y:
	Using automatic threshold for unique fragments: 1196.702251550075
	Using automatic threshold for TSS enrichment: 1.755061885906123
10y:
	Using automatic threshold for unique fragments: 1559.4139363192448
	Using automatic threshold for TSS enrichment: 1.7847453694900661
16y:
	Using automatic threshold for unique fragments: 1166.1667678117858
	Using automatic threshold for TSS enrichment: 1.8197448445720958
20y:
	Using automatic threshold for unique fragments: 1384.3432251571178
	Using automatic threshold for TSS enrichment: 1.8283237384472089
40y:
	Using automatic threshold for unique fragments: 731.7364693961513
	Using automatic threshold for TSS enrichment: 1.651448280214018
ga22:
	Using automatic threshold for unique fragments: 1116.659766852988
	Using automatic threshold for TSS enrichment: 1.4639067842865912
ga24:
	Using automatic threshold for unique fragments: 1220.5904178052185
	Using automatic threshold for TSS enrichment: 1.6073671313939895
2024-07-17 11:23:26,868 cisTopic     INFO     Reading data for 1m
2024-07-17 11:24:26,313 cisTopic     INFO     metrics provided!
2024-07-17 11:24:29,408 cisTopic     INFO     Counting fragments in regions
2024-07-17 11:24:37,062 cisTopic     INFO     Creating fragment matrix
2024-07-17 11:24:46,871 cisTopic     INFO     Converting fragment matrix to sparse matrix
2024-07-17 11:24:50,838 cisTopic     INFO     Removing blacklisted regions
2024-07-17 11:24:52,071 cisTopic     INFO     Creating CistopicObject
2024-07-17 11:24:52,729 cisTopic     INFO     Done!
2024-07-17 11:24:54,164 cisTopic     INFO     Reading data for 3m
2024-07-17 11:26:07,834 cisTopic     INFO     metrics provided!
2024-07-17 11:26:10,983 cisTopic     INFO     Counting fragments in regions
2024-07-17 11:26:14,608 cisTopic     INFO     Creating fragment matrix
2024-07-17 11:26:19,317 cisTopic     INFO     Converting fragment matrix to sparse matrix
2024-07-17 11:26:21,017 cisTopic     INFO     Removing blacklisted regions
2024-07-17 11:26:22,152 cisTopic     INFO     Creating CistopicObject
2024-07-17 11:26:22,615 cisTopic     INFO     Done!
2024-07-17 11:26:24,176 cisTopic     INFO     Reading data for 6m
2024-07-17 11:28:15,632 cisTopic     INFO     metrics provided!
2024-07-17 11:28:19,988 cisTopic     INFO     Counting fragments in regions
2024-07-17 11:28:22,472 cisTopic     INFO     Creating fragment matrix
2024-07-17 11:28:26,706 cisTopic     INFO     Converting fragment matrix to sparse matrix
2024-07-17 11:28:28,495 cisTopic     INFO     Removing blacklisted regions
2024-07-17 11:28:29,555 cisTopic     INFO     Creating CistopicObject
2024-07-17 11:28:29,973 cisTopic     INFO     Done!
2024-07-17 11:28:31,440 cisTopic     INFO     Reading data for 10m
2024-07-17 11:29:34,333 cisTopic     INFO     metrics provided!
2024-07-17 11:29:37,167 cisTopic     INFO     Counting fragments in regions
2024-07-17 11:29:40,874 cisTopic     INFO     Creating fragment matrix
2024-07-17 11:29:45,970 cisTopic     INFO     Converting fragment matrix to sparse matrix
2024-07-17 11:29:47,848 cisTopic     INFO     Removing blacklisted regions
2024-07-17 11:29:49,156 cisTopic     INFO     Creating CistopicObject
2024-07-17 11:29:49,622 cisTopic     INFO     Done!
2024-07-17 11:29:51,181 cisTopic     INFO     Reading data for 1y
2024-07-17 11:31:05,387 cisTopic     INFO     metrics provided!
2024-07-17 11:31:08,312 cisTopic     INFO     Counting fragments in regions
2024-07-17 11:31:12,453 cisTopic     INFO     Creating fragment matrix
2024-07-17 11:31:18,987 cisTopic     INFO     Converting fragment matrix to sparse matrix
2024-07-17 11:31:22,151 cisTopic     INFO     Removing blacklisted regions
2024-07-17 11:31:23,267 cisTopic     INFO     Creating CistopicObject
2024-07-17 11:31:23,747 cisTopic     INFO     Done!
2024-07-17 11:31:25,315 cisTopic     INFO     Reading data for 2y
2024-07-17 11:32:30,612 cisTopic     INFO     metrics provided!
2024-07-17 11:32:33,884 cisTopic     INFO     Counting fragments in regions
2024-07-17 11:32:37,753 cisTopic     INFO     Creating fragment matrix
2024-07-17 11:32:43,910 cisTopic     INFO     Converting fragment matrix to sparse matrix
2024-07-17 11:32:46,702 cisTopic     INFO     Removing blacklisted regions
2024-07-17 11:32:47,808 cisTopic     INFO     Creating CistopicObject
2024-07-17 11:32:48,282 cisTopic     INFO     Done!
2024-07-17 11:32:49,841 cisTopic     INFO     Reading data for 4y
2024-07-17 11:33:57,757 cisTopic     INFO     metrics provided!
2024-07-17 11:34:01,131 cisTopic     INFO     Counting fragments in regions
2024-07-17 11:34:05,755 cisTopic     INFO     Creating fragment matrix
2024-07-17 11:34:12,271 cisTopic     INFO     Converting fragment matrix to sparse matrix
2024-07-17 11:34:14,932 cisTopic     INFO     Removing blacklisted regions
2024-07-17 11:34:15,996 cisTopic     INFO     Creating CistopicObject
2024-07-17 11:34:16,468 cisTopic     INFO     Done!
2024-07-17 11:34:17,874 cisTopic     INFO     Reading data for 6y
2024-07-17 11:34:50,756 cisTopic     INFO     metrics provided!
2024-07-17 11:34:52,202 cisTopic     INFO     Counting fragments in regions
2024-07-17 11:34:53,454 cisTopic     INFO     Creating fragment matrix
2024-07-17 11:34:55,277 cisTopic     INFO     Converting fragment matrix to sparse matrix
2024-07-17 11:34:56,047 cisTopic     INFO     Removing blacklisted regions
2024-07-17 11:34:56,853 cisTopic     INFO     Creating CistopicObject
2024-07-17 11:34:57,132 cisTopic     INFO     Done!
2024-07-17 11:34:58,603 cisTopic     INFO     Reading data for 10y
2024-07-17 11:35:50,681 cisTopic     INFO     metrics provided!
2024-07-17 11:35:53,401 cisTopic     INFO     Counting fragments in regions
2024-07-17 11:35:57,562 cisTopic     INFO     Creating fragment matrix
2024-07-17 11:36:04,116 cisTopic     INFO     Converting fragment matrix to sparse matrix
2024-07-17 11:36:06,940 cisTopic     INFO     Removing blacklisted regions
2024-07-17 11:36:08,026 cisTopic     INFO     Creating CistopicObject
2024-07-17 11:36:08,492 cisTopic     INFO     Done!
2024-07-17 11:36:10,175 cisTopic     INFO     Reading data for 16y
2024-07-17 11:37:23,594 cisTopic     INFO     metrics provided!
2024-07-17 11:37:27,195 cisTopic     INFO     Counting fragments in regions
2024-07-17 11:37:34,571 cisTopic     INFO     Creating fragment matrix
2024-07-17 11:37:44,955 cisTopic     INFO     Converting fragment matrix to sparse matrix
2024-07-17 11:37:49,222 cisTopic     INFO     Removing blacklisted regions
2024-07-17 11:37:50,343 cisTopic     INFO     Creating CistopicObject
2024-07-17 11:37:50,966 cisTopic     INFO     Done!
2024-07-17 11:37:52,738 cisTopic     INFO     Reading data for 20y
2024-07-17 11:39:14,940 cisTopic     INFO     metrics provided!
2024-07-17 11:39:18,521 cisTopic     INFO     Counting fragments in regions
2024-07-17 11:39:24,735 cisTopic     INFO     Creating fragment matrix
2024-07-17 11:39:33,785 cisTopic     INFO     Converting fragment matrix to sparse matrix
2024-07-17 11:39:37,356 cisTopic     INFO     Removing blacklisted regions
2024-07-17 11:39:38,437 cisTopic     INFO     Creating CistopicObject
2024-07-17 11:39:39,008 cisTopic     INFO     Done!
2024-07-17 11:39:40,579 cisTopic     INFO     Reading data for 40y
2024-07-17 11:40:16,169 cisTopic     INFO     metrics provided!
2024-07-17 11:40:17,801 cisTopic     INFO     Counting fragments in regions
2024-07-17 11:40:19,760 cisTopic     INFO     Creating fragment matrix
2024-07-17 11:40:23,796 cisTopic     INFO     Converting fragment matrix to sparse matrix
2024-07-17 11:40:25,861 cisTopic     INFO     Removing blacklisted regions
2024-07-17 11:40:26,820 cisTopic     INFO     Creating CistopicObject
2024-07-17 11:40:27,174 cisTopic     INFO     Done!
2024-07-17 11:40:28,804 cisTopic     INFO     Reading data for ga22
2024-07-17 11:41:49,065 cisTopic     INFO     metrics provided!
2024-07-17 11:41:52,488 cisTopic     INFO     Counting fragments in regions
2024-07-17 11:41:55,572 cisTopic     INFO     Creating fragment matrix
2024-07-17 11:41:59,635 cisTopic     INFO     Converting fragment matrix to sparse matrix
2024-07-17 11:42:01,429 cisTopic     INFO     Removing blacklisted regions
2024-07-17 11:42:02,533 cisTopic     INFO     Creating CistopicObject
2024-07-17 11:42:02,978 cisTopic     INFO     Done!
2024-07-17 11:42:04,705 cisTopic     INFO     Reading data for ga24
2024-07-17 11:43:13,872 cisTopic     INFO     metrics provided!
2024-07-17 11:43:16,691 cisTopic     INFO     Counting fragments in regions
2024-07-17 11:43:20,774 cisTopic     INFO     Creating fragment matrix
2024-07-17 11:43:27,316 cisTopic     INFO     Converting fragment matrix to sparse matrix
2024-07-17 11:43:30,342 cisTopic     INFO     Removing blacklisted regions
2024-07-17 11:43:31,429 cisTopic     INFO     Creating CistopicObject
2024-07-17 11:43:31,899 cisTopic     INFO     Done!
2024-07-17 11:43:36,930 cisTopic     INFO     cisTopic object 1 merged
2024-07-17 11:43:40,317 cisTopic     INFO     cisTopic object 2 merged
2024-07-17 11:43:43,815 cisTopic     INFO     cisTopic object 3 merged
2024-07-17 11:43:47,536 cisTopic     INFO     cisTopic object 4 merged
2024-07-17 11:43:51,469 cisTopic     INFO     cisTopic object 5 merged
2024-07-17 11:43:55,650 cisTopic     INFO     cisTopic object 6 merged
2024-07-17 11:43:59,856 cisTopic     INFO     cisTopic object 7 merged
2024-07-17 11:44:04,404 cisTopic     INFO     cisTopic object 8 merged
2024-07-17 11:44:09,184 cisTopic     INFO     cisTopic object 9 merged
2024-07-17 11:44:14,389 cisTopic     INFO     cisTopic object 10 merged
2024-07-17 11:44:19,760 cisTopic     INFO     cisTopic object 11 merged
2024-07-17 11:44:24,981 cisTopic     INFO     cisTopic object 12 merged
2024-07-17 11:44:30,491 cisTopic     INFO     cisTopic object 13 merged
/home/michal.kubacki/.conda/envs/scenicplus/lib/python3.11/site-packages/scrublet/helper_functions.py:252: RuntimeWarning: invalid value encountered in sqrt
  CV_input = np.sqrt(b);
(61871, 25)
(61669, 25)
True
True
Warning: Some cells in this CistopicObject are not present in this cell_data. Values will be filled with Nan

Preprocessing...
Simulating doublets...
Embedding transcriptomes using PCA...
Calculating doublet scores...
Automatically set threshold at doublet score = 0.84
Detected doublet rate = 0.0%
Estimated detectable doublet fraction = 0.1%
Overall doublet rate:
	Expected   = 10.0%
	Estimated  = 6.9%
Elapsed time: 339.1 seconds
Detected doublet rate = 27.6%
Estimated detectable doublet fraction = 67.0%
Overall doublet rate:
	Expected   = 10.0%
	Estimated  = 41.1%
CistopicObject from project cisTopic_merge with n_cells × n_regions = 14214 × 485800
slurmstepd: error: _cgroup_procs_check: failed on path /sys/fs/cgroup/memory/slurm/uid_10666/job_13586670/step_batch/cgroup.procs: No such file or directory
slurmstepd: error: unable to read '/sys/fs/cgroup/memory/slurm/uid_10666/job_13586670/step_batch/cgroup.procs'
